<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>美化删除操作之回调</title>
        <meta name="viewport" content="initial-scale=1,maximum-scale=3,minimum-scale=1,user-scalable=no">
        <style>
            *{
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
            .container{
                width: 600px;
                margin: 0 auto;
            }
            ul{
                text-align: center;
            }
            li{
                width: 80px;
                height: 80px;
                line-height: 80px;
                text-align: center;
                color:#fff;
                margin: 15px auto;
                background-color: green;
                border-radius: 50%;
                cursor: pointer;
            }
            .modal{
                position: fixed;
                top: 0;
                right: 0;
                width: 100%;
                height: 100%;
                background-color: #000;
                opacity: .8;
                z-index: 1000;
                display: none;
            }
            .inner{
                position: absolute;
                top: 50%;
                left:50%;
                width: 400px;
                height: 200px;
                background-color: #fff;
                transform: translate(-50%,-50%);
                z-index: 1200;
            }
            .inner h2{
                text-align: center;
                margin: 10px 0;
            }
            .btn{
                position: absolute;
                bottom:20px;
                display: inline-block;
                width: 80px;
                height: 40px;
                border-radius: 6px;
                color: #fff;
                text-align: center;
                line-height: 40px;
                cursor: pointer;

            }
            .btnCancel{
                left:40px;
                background-color: #c33;
            }
            .btnSure{
                right:40px;
                background-color: green;
            }
            h3{
                text-align: center;
                margin: 10px;
                color: 999;
            }
            .reload{
                width: 100px;
                height: 40px;
                line-height: 40px;
                position: absolute;
                /*bottom: 20%;
                left: 50%;
                transform: translate(-50%,0);*/
                left: 50%;
                margin-left: -50px;
                margin-top: 40px;
                text-align: center;
                background-color: #c33;
                border-radius: 4px;
                color: #fff;
                font-size: 16px;
                cursor: pointer;
            }
            @media screen and (max-width: 1080px){
                .container{
                    width: 100%;
                }
                .inner{
                    position: absolute;
                    top: 50%;
                    left:50%;
                    width: 90%;
                    height: 200px;
                    background-color: #fff;
                    transform: translate(-50%,-50%);
                }
                li{
                    width: 60px;
                    height: 60px;
                    line-height: 60px;
                    text-align: center;
                    color:#fff;
                    margin: 15px auto;
                    background-color: green;
                    border-radius: 50%;
                    cursor: pointer;
                }
            }
        </style>
    </head>
    <body>
        <h3>美化删除操作之回调函数</h3>
        <div class="container">
            <ul>
                <li>1</li>
                <li>2</li>
                <li>3</li>
                <li>4</li>
            </ul>
        </div>
        <div class="modal">
            <div class="inner">
                <h2>确定要删除吗？</h2>
                <div>
                    <span class="btn btnCancel">取消</span>
                    <span class="btn btnSure">确定</span>
                </div>
            </div>
        </div>
        <div class="reload">
            刷新页面
        </div>
        <script>
            (function(){
                function $(el){
                    return document.querySelector(el);
                }
                function $$(el){
                    return document.querySelectorAll(el);
                }
                //
                var lis = $$('.container li');
                var modal = $('.modal');
                var btnCancel = $('.btnCancel');
                var btnSure = $('.btnSure');

                function show(el){
                    return el.style.display = 'block';
                }
                function hide(el){
                    return el.style.display = 'none';
                }
                function del(fn){
                    btnSure.onclick = function(){
                        hide(modal);
                        fn && fn();
                    }
                };
                //移动端太多浏览器不支持forEach
                // lis.forEach(function(v,k){
                //     //console.log(this); window
                //     v.onclick = function(){
                //         var that = this;
                //         //console.log(that); li
                //         show(modal);
                //         del(function(){
                //             that.remove();
                //         })
                //     }
                // });
                //自定义foreach
                each(lis,function(k,v){
                    //console.log(this); window
                    v.onclick = function(){
                        var that = this;
                        //console.log(that); li
                        show(modal);
                        del(function(){
                            that.remove();
                        })
                    }
                })
                btnCancel.onclick = function(){
                    hide(modal);
                }
                //
                $('.reload').onclick = function(){
                    location.reload();
                }

                //兼容forEach 实现jquery each
                function each(obj,callback){
                    var i = 0,
                        value,
                        len = obj.length;
                    for(var i=0 ;i<len;i++){
                        value = callback.call( this, i, obj[ i ] );
                        if ( value === false ) {
                            break;
                        }
                    }
                    return obj;
                }
            })()

        </script>
    </body>
</html>
